<link rel="stylesheet" href="https://unpkg.com/grapesjs/dist/css/grapes.min.css">
<script src="https://unpkg.com/grapesjs@0.14.15/dist/grapes.js"></script>
<div id="gjs"></div>

<script type="text/javascript">

    grapesjs.plugins.add('my-plugin-name', (editor, options) => {

        //adiciona um novo componente
        var blockManager = editor.BlockManager;
        blockManager.add('modal', {
            label: 'Heading',
            content: `<custom-element angular-component-type="modal">
                <span data-gjs-editable="false">Not editable</span>
<span data-gjs-draggable="false">Not draggable</span>
<span data-gjs-removable="false">Not removable</span>
            </custom-element>`,
            category: 'custom',
            attributes: {
                title: 'Insert h1 block',
                class: 'fa fa-youtube-play',
            }
        });

        var comps = editor.DomComponents;

        // Get the model and the view from the default Component type
        var defaultType = comps.getType('default');
        var defaultModel = defaultType.model;
        var defaultView = defaultType.view;

        var inputTypes = [
            { value: 'text', name: 'Text' },
            { value: 'email', name: 'Email' },
            { value: 'password', name: 'Password' },
            { value: 'number', name: 'Number' },
        ];

        // The `input` will be the Component type ID
        comps.addType('modal', {
            // Define the Model
            model: defaultModel.extend({
                // Extend default properties
                defaults: Object.assign({}, defaultModel.prototype.defaults, {
                    // Can be dropped only inside `form` elements
                    draggable: 'body *',

                    // Can't drop other elements inside it
                    droppable: false,
                    // Traits (Settings)
                    traits: ['name', 'placeholder', {
                        // Change the type of the input (text, password, email, etc.)
                        type: 'select',
                        label: 'Type',
                        name: 'type',
                        options: inputTypes,
                    }, {
                            // Can make it required for the form
                            type: 'checkbox',
                            label: 'Required',
                            name: 'required',
                        }],
                }),
                toHTML: function () {
                    return '<modal></modal>';
                },
            },
                // The second argument of .extend are static methods and we'll put inside our
                // isComponent() method. As you're putting a new Component type on top of the stack,
                // not declaring isComponent() might probably break stuff, especially if you extend
                // the default one.
                {
                    isComponent: function (el) {
                        if (el.tagName == 'MODAL' || (el.tagName == 'CUSTOM-ELEMENT' && (el.attributes['angular-component-type'] || { value: '' }).value == 'modal')) {
                            return { type: 'modal' };
                        }
                    },
                }),

            // Define the View

            view: defaultType.view.extend({
                /*
                  // Bind events
                  events: {
                      // If you want to bind the event to children elements
                      // 'click .someChildrenClass': 'methodName',
                      click: 'handleClick',
                      dblclick: function () {
                          alert('Hi!');
                      }
                  },
  
                  // It doesn't make too much sense this method inside the component
                  // but it's ok as an example
                  randomHex: function () {
                      return '#' + Math.floor(Math.random() * 16777216).toString(16);
                  },
  
                  handleClick: function (e) {
                      this.model.set('style', { color: this.randomHex() }); // <- Affects the final HTML code
                      this.el.style.backgroundColor = this.randomHex(); // <- Doesn't affect the final HTML code
                      // Tip: updating the model will reflect the changes to the view, so, in this case,
                      // if you put the model change after the DOM one this will override the backgroundColor
                      // change made before
                  },
  */
                // The render() should return 'this'
                render: function () {

                    defaultType.view.prototype.render.apply(this, arguments);

                    //els.removeEventListener('mouseenter')
                    return this;

                    // Extend the original render method
                    //                   
                    //                 this.el.placeholder = 'Text here'; // <- Doesn't affect the final HTML code
                    //               return this;
                },
            }),
        });
    })

    var editor = grapesjs.init({
        container: '#gjs',
        components: '<div class="txt-red">Hello world!</div>',
        style: '.txt-red{color: red}',
        plugins: ['my-plugin-name'],
    });



</script>